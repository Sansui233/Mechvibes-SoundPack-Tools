from __future__ import annotations

from typing import Final

from mspt.schema.mvdx import KeyName

# Keycodes are the "standard" keycodes used by Mechvibes (uiohook-style),
# as documented by the upstream project.
# This mapping is intentionally limited to the keys supported by our KeyName list.
KEYNAME_TO_KEYCODE: Final[dict[str, int]] = {
    "Escape": 1,
    "F1": 59,
    "F2": 60,
    "F3": 61,
    "F4": 62,
    "F5": 63,
    "F6": 64,
    "F7": 65,
    "F8": 66,
    "F9": 67,
    "F10": 68,
    "F11": 87,
    "F12": 88,
    "Backquote": 41,
    "Digit1": 2,
    "Digit2": 3,
    "Digit3": 4,
    "Digit4": 5,
    "Digit5": 6,
    "Digit6": 7,
    "Digit7": 8,
    "Digit8": 9,
    "Digit9": 10,
    "Digit0": 11,
    "Minus": 12,
    "Equal": 13,
    "Backspace": 14,
    "Tab": 15,
    "CapsLock": 58,
    "KeyQ": 16,
    "KeyW": 17,
    "KeyE": 18,
    "KeyR": 19,
    "KeyT": 20,
    "KeyY": 21,
    "KeyU": 22,
    "KeyI": 23,
    "KeyO": 24,
    "KeyP": 25,
    "BracketLeft": 26,
    "BracketRight": 27,
    "Backslash": 43,
    "KeyA": 30,
    "KeyS": 31,
    "KeyD": 32,
    "KeyF": 33,
    "KeyG": 34,
    "KeyH": 35,
    "KeyJ": 36,
    "KeyK": 37,
    "KeyL": 38,
    "Semicolon": 39,
    "Quote": 40,
    "Enter": 28,
    "ShiftLeft": 42,
    "ShiftRight": 54,
    "KeyZ": 44,
    "KeyX": 45,
    "KeyC": 46,
    "KeyV": 47,
    "KeyB": 48,
    "KeyN": 49,
    "KeyM": 50,
    "Comma": 51,
    "Period": 52,
    "Slash": 53,
    "ControlLeft": 29,
    "AltLeft": 56,
    "Space": 57,
    "PrintScreen": 3639,
    "ScrollLock": 70,
    "Pause": 3653,
    "Insert": 3666,
    "Delete": 3667,
    "Home": 3655,
    "End": 3663,
    "PageUp": 3657,
    "PageDown": 3665,
    "ArrowUp": 57416,
    "ArrowLeft": 57419,
    "ArrowRight": 57421,
    "ArrowDown": 57424,
    # Numpad
    "NumLock": 69,
    "NumpadDivide": 3637,
    "NumpadMultiply": 55,
    "NumpadSubtract": 74,
    "NumpadAdd": 78,
    "NumpadEnter": 3612,
    "NumpadDecimal": 83,
    "Numpad0": 82,
    "Numpad1": 79,
    "Numpad2": 80,
    "Numpad3": 81,
    "Numpad4": 75,
    "Numpad5": 76,
    "Numpad6": 77,
    "Numpad7": 71,
    "Numpad8": 72,
    "Numpad9": 73,
}


def keyname_to_keycode(key: KeyName) -> int:
    try:
        return KEYNAME_TO_KEYCODE[key]
    except KeyError as exc:
        raise KeyError(f"Unsupported KeyName for Mechvibes keycodes: {key}") from exc
